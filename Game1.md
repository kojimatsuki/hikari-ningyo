# 🎮 ゲーム企画書「まいごの人形たち 〜やくそくのよる〜」

## 📝 ストーリー原案（子供の音声入力から）

> このゲームは人形が動くゲームです。そして今やってるプレイヤーは、人間の役ではありません。人形の役をするのです。そして迷子になった人形をどんどん助けていきます。そしてシークレットの迷子の人形を見つけたら、あなたは1位となるでしょう。そして人間にもいいと思われるでしょう。でも、その夜人形は遊んでいました。そして子供はこんな人形なんていらないと叫んで捨ててしまいました。どんどんどんどん捨てられて、迷子の人が増えてしまいました。私まで迷子になってしまったみたいです。なんで迷子になったか、それはみんなが約束を破ったからです。それはレベルアップしてからの内緒です。

-----

## 🧸 ストーリー整理

プレイヤーは**人形**。人間ではない。

ある夜、人形たちは子供が寝た後にこっそり遊んでいた。
でも子供に見つかってしまい、「こんな人形なんていらない！」と捨てられてしまった。
次々と捨てられる人形たち。どんどん迷子が増えていく。
そしてついに主人公の人形も迷子になってしまった。

**迷子になった本当の理由** — それは「みんなが約束を破ったから」。
でもその秘密は、レベルアップしてからじゃないとわからない…。

主人公の人形は、迷子になった仲間の人形たちを探して助けていく。
どこかに隠された**シークレットの人形**を見つけたら、あなたは1位。
そして人間にも「いい人形だ」と認めてもらえるかもしれない。

-----

## 🎯 Claude Codeへの指示

上記のストーリーをもとに、以下の仕様でブラウザゲームを作ってください。

### ゲーム基本設定

- **タイトル**: 「まいごの人形たち 〜やくそくのよる〜」
- **ゲーム形式**: ブラウザで遊べるHTML+CSS+JavaScript（ファイル分割構成）
- **ジャンル**: 探索アドベンチャー＋コレクション
- **対象年齢**: 子供向け（小学生）
- **操作方法**: クリック／タップ（スマホ・タブレット対応）
- **プレイ時間目安**: 15〜25分
- **雰囲気**: 夜の少し寂しい世界。でも仲間を見つけるたびに温かくなっていく

### 技術要件

- 外部ライブラリ不要（Canvas APIまたはDOM操作で実装）
- レスポンシブ対応（PC・タブレット両方で遊べる）
- 日本語テキスト
- 絵文字ベースのビジュアル（🧸🪆🎎👧🌙🏠🌳🗑️）

### ファイル構成（適度に分割すること）

役割ごとにファイルを分割し、保守しやすい構成にする。以下は推奨構成：

```
game/
├── index.html          # エントリーポイント（HTMLのみ）
├── css/
│   └── style.css       # 全体のスタイル・アニメーション
├── js/
│   ├── main.js         # ゲーム初期化・メインループ
│   ├── scenes.js       # シーン管理（タイトル/探索/イベント/エンディング）
│   ├── map.js          # マップ・エリア移動ロジック
│   ├── dolls.js        # 人形データ・コレクション管理
│   ├── story.js        # ストーリー進行・約束の秘密の解放
│   ├── ui.js           # UI描画・人形図鑑・メッセージ表示
│   ├── audio.js        # Web Audio API サウンド管理
│   └── data.js         # セリフ・マップデータ・人形定義
└── README.md           # 遊び方の説明
```

#### 分割の方針

- **1ファイル300行以下**を目安に分割する
- 各ファイルは単一の責務を持つ
- `data.js` にセリフやステータスなどのデータを集約し、ロジックと分離する
- JSファイルはES Modules（import/export）で連携する
- `index.html` は `<script type="module" src="js/main.js">` で読み込む

-----

## 🗺️ ゲーム構成

### オープニング

1. 夜の子供部屋。人形たちがこっそり遊んでいる（かわいい演出）
1. 突然、子供が起きる👧💢
1. 「こんな人形なんていらない！」— 人形たちが次々と捨てられる
1. 画面が暗くなり、主人公の人形🧸が暗い場所で目を覚ます
1. 「…わたしも、まいごになっちゃった」

### ステージ1：ゴミ捨て場（はじまりの場所）

- **場所**: 夜のゴミ捨て場。段ボールやゴミ袋の間に捨てられた人形たち
- **背景**: 🗑️📦🌙（暗いけど月明かりがある）
- **できること**:
  - マップをクリック/タップして移動
  - 光っている場所を調べると迷子の人形を発見
  - 助けた人形が仲間になり「人形図鑑」に登録される
- **見つかる人形**:
  - 🧸 くまのぬいぐるみ「ポン」— 段ボールの中で泣いている
  - 🪆 マトリョーシカ「マトちゃん」— ゴミ袋に挟まっている
- **レベルアップ条件**: 2体の人形を助ける → Lv2へ

### ステージ2：夜の公園

- **場所**: 暗い公園。ブランコや滑り台の影に人形が隠れている
- **背景**: 🌳🌙⭐（星が少し出てきて明るくなる）
- **できること**:
  - エリアが広がり、探索範囲が増える
  - 一部の人形はパズルやミニイベントをクリアしないと助けられない
- **見つかる人形**:
  - 🎎 日本人形「おひなちゃん」— 砂場に埋まっている
  - 🤖 ロボットのおもちゃ「ガチャン」— ブランコに引っかかっている
  - 🐰 うさぎのぬいぐるみ「ミミ」— 滑り台の下で震えている
- **ストーリーイベント**: Lv2になると最初のヒントが解放される
  - 「…思い出した。わたしたち、やくそくをしたんだ」
- **レベルアップ条件**: さらに3体助ける → Lv3へ

### ステージ3：忘れられた路地裏

- **場所**: 古い路地裏。雨が降っている
- **背景**: 🏚️🌧️💧（寂しい雰囲気だが、見つけた仲間が元気をくれる）
- **できること**:
  - 仲間の人形たちが手がかりをくれるようになる
  - 「約束」の記憶が少しずつ明らかに
- **見つかる人形**:
  - 🎪 ピエロ人形「パッチ」— 古い劇場の前に倒れている
  - 👸 お姫様人形「ローザ」— 壊れた窓の向こうに見える
- **ストーリーイベント**: Lv3で第2のヒント解放
  - 「やくそく…それは”夜に遊ばない”こと。でも私たちは破ってしまった」
  - 「だから子供に嫌われて、捨てられたんだ…」

### ステージ4：子供の家への帰り道

- **場所**: 夜明け前の住宅街。少しずつ空が明るくなっている
- **背景**: 🏠🌅✨（希望が見えてくる演出）
- **最終目標**: シークレットの人形を見つける
- **シークレットの人形**:
  - 🌟 光る人形「ヒカリ」— 特別な場所に隠されている
  - 見つけるには全ステージのヒントを集める必要がある
  - ヒカリを見つけると「1位」の称号が得られる

### エンディング

- **通常エンディング**（シークレット未発見）:
  - 迷子の人形たちと一緒に朝を迎える
  - 「もう約束は破らない。いつか子供が迎えに来てくれるかな…」
  - 温かいけど少し切ない終わり
- **真エンディング**（シークレット発見）:
  - ヒカリの力で人形たちが子供の家に帰れる
  - 子供が朝起きて人形を見つける
  - 「…ごめんね。捨てたりしないよ」
  - 人間にも「いい人形だ」と思ってもらえる
  - 🌟「あなたは1位です」🌟の演出

-----

## 🎨 ビジュアル・演出

- **スタイル**: 絵文字＋テキストベース。夜の雰囲気を暗めの背景色で表現
- **キャラクター表示**:
  - 主人公: 🧸（通常）→ 😢（悲しい時）→ 😊（仲間を見つけた時）
  - 迷子の人形たち: 各種絵文字（見つける前は❓シルエット）
  - 子供: 👧（回想シーンのみ）
- **画面の変化**:
  - ステージが進むごとに背景が少しずつ明るくなる（夜→夜明け）
  - 仲間が増えるほど画面下に人形が並んでいく
- **人形図鑑**: 集めた人形を一覧で見られる画面。シークレット枠は「？？？」表示
- **演出**:
  - 人形発見時: キラキラエフェクト✨＋温かい効果音
  - 約束の記憶解放時: 画面がフラッシュして回想シーン
  - シークレット発見時: 特別な演出（画面全体が光る）

## 🔊 サウンド

- Web Audio APIで簡易サウンド:
  - BGM: 夜の静かなオルゴール風メロディ（ステージごとに少し変化）
  - 人形発見音: 温かいチャイム音
  - 足音: 小さくてかわいい足音
  - 約束の記憶: 切ないピアノ音
  - シークレット発見: 壮大なファンファーレ
  - エンディング: 優しいオルゴール

## 📊 ゲームシステム

- **探索型**: マップをクリック/タップして移動・調べる
- **レベルシステム**: 人形を助けるとEXP → レベルアップで新エリア解放＆ストーリー進行
- **人形図鑑**: コレクション要素。全部集めるとシークレットのヒントが完成
- **約束の秘密**: レベルアップごとに少しずつ明かされる（プレイヤーの好奇心を引く）
- **難易度**: 優しめ。探索を楽しむゲーム。ゲームオーバーなし（迷子の人形が安心できるように）

## 📱 必須UI要素

- タイトル画面（ゲーム名＋雰囲気のある夜空の演出＋「はじめる」ボタン）
- オープニングストーリー（テキスト送りで読める）
- 探索画面（マップ＋クリックポイント＋画面下に仲間の人形一覧）
- 人形発見イベント画面（人形の名前・紹介テキスト）
- 人形図鑑画面（いつでも開ける）
- レベルアップ＆ストーリー解放演出
- エンディング画面（通常＆真エンディング）
- メニュー（図鑑を見る・ストーリーを振り返る）

-----

## 🚀 Claude Codeでの実行方法

### 方法1: –dangerously-skip-permissions で全自動（おすすめ）

確認なしで一気に最後まで作ってくれる。

```bash
claude --dangerously-skip-permissions "このゲーム企画書の仕様に沿って、ファイル構成どおりに分割してブラウザゲームを作ってください。夜の雰囲気が大事な探索アドベンチャーです。途中で確認せず最後まで一気に完成させてください。" -f game-spec-dolls.md
```

### 方法2: allowedTools で必要な権限だけ許可

```bash
claude --allowedTools "Edit,Write,Bash(cat*),Bash(open*),Bash(mkdir*)" "このゲーム企画書の仕様に沿って、ファイル構成どおりに分割してブラウザゲームを作ってください。途中で確認せず最後まで一気に完成させてください。" -f game-spec-dolls.md
```

### 💡 プロンプトのコツ

どの方法でも、プロンプトに以下を入れると止まりにくくなる：

- **「途中で確認せず最後まで一気に完成させて」**
- **「質問せずに自分で判断して進めて」**
- **「完成したらブラウザで開いて」**